{"version":3,"file":"commonHelpers.js","sources":["../src/main.js"],"sourcesContent":["// import iziToast from 'izitoast';\n// import 'izitoast/dist/css/iziToast.min.css';\n\n// import SimpleLightbox from 'simplelightbox';\n// import 'simplelightbox/dist/simple-lightbox.min.css';\n\n// const formEl = document.querySelector('.form');\n// const galleryEl = document.querySelector('.gallery');\n// const loader = document.querySelector('.loader');\n// loader.style.display = 'none';\n// let lightbox = new SimpleLightbox('.gallery a', {\n//   captions: true,\n//   captionDelay: 250,\n//   captionsData: 'alt',\n// });\n\n// formEl.addEventListener('submit', onSubmitForm);\n\n// async function onSubmitForm(e) {\n//   e.preventDefault();\n\n//   const inputElText = getInputText();\n//   if (!inputElText) return;\n\n//   galleryEl.innerHTML = '';\n//   loader.style.display = 'inline-block';\n\n//   fetchImg(inputElText)\n//     .then(images => renderImg(images))\n//     .catch(error => {\n//       console.log(error);\n//       loader.style.display = 'none';\n//     });\n//   e.target.reset();\n// }\n\n// function getInputText() {\n//   return document.querySelector('input').value.trim();\n// }\n\n// function fetchImg(inputElText) {\n//   const searchParams = new URLSearchParams({\n//     key: '42110229-d56f9063956695e15527c98fc',\n//     q: inputElText,\n//     image_type: 'photo',\n//     orientation: 'horizontal',\n//     safesearch: 'true',\n//   });\n//   return fetch(`https://pixabay.com/api/?${searchParams}`).then(response => {\n//     if (!response.ok) {\n//       throw new Error(response.status);\n//     }\n//     return response.json();\n//   });\n// }\n\n// function renderImg(images) {\n//   if (images.hits.length === 0) {\n//     iziToast.show({\n//       message:\n//         'Sorry, there are no images matching your search query. Please try again!',\n//       messageColor: '#FAFAFB',\n//       messageSize: '16px',\n//       messageLineHeight: '24px',\n//       backgroundColor: '#B51B1B',\n//       color: '#FAFAFB',\n//       position: 'topRight',\n//     });\n//   } else {\n//     const galleryMarkup = images.hits\n//       .map(\n//         image =>\n//           `<li class=\"gallery-item\">\n//       <a class=\"gallery-link\" href=\"${image.largeImageURL}\">\n//         <img\n//           class=\"gallery-image\"\n//           src=\"${image.webformatURL}\"\n//               alt=\"${image.tags}\"\n//         />\n//       </a>\n//       <div class=\"img-info\">\n//       <p>Likes: ${image.likes}</p>\n//       <p>Views: ${image.views}</p>\n//       <p>Comments: ${image.comments}</p>\n//       <p>Downloads: ${image.downloads}</p>\n//       </div>\n//       </li>`\n//       )\n//       .join('');\n\n//     galleryEl.insertAdjacentHTML('beforeend', galleryMarkup);\n\n//     lightbox.refresh();\n//   }\n//   loader.style.display = 'none';\n// }\n\n// ===============================================\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport axios from 'axios';\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nconst formEl = document.querySelector('.form');\nconst galleryEl = document.querySelector('.gallery');\nconst loader = document.querySelector('.loader');\nconst loadMoreBtn = document.querySelector('.load-more');\nconst endMessage = document.querySelector('.end-message');\nlet currentPage = 1;\nlet searchQuery = '';\nlet totalHits = 0;\nlet cardHeight = 0;\n\nloader.style.display = 'none';\nloadMoreBtn.style.display = 'none';\n\nformEl.addEventListener('submit', onSubmitForm);\nloadMoreBtn.addEventListener('click', onLoadMore);\n\nasync function onSubmitForm(e) {\n  e.preventDefault();\n  searchQuery = getInputText();\n  if (searchQuery === '') {\n    return;\n  }\n  galleryEl.innerHTML = '';\n  loader.style.display = 'inline-block';\n  currentPage = 1;\n  await fetchAndRenderImages();\n  loadMoreBtn.style.display = 'inline-block';\n}\n\nfunction getInputText() {\n  return document.querySelector('input').value.trim();\n}\n\nasync function fetchAndRenderImages() {\n  try {\n    const response = await axios.get('https://pixabay.com/api/', {\n      params: {\n        key: '42110229-d56f9063956695e15527c98fc',\n        q: searchQuery,\n        image_type: 'photo',\n        orientation: 'horizontal',\n        safesearch: 'true',\n        page: currentPage,\n        per_page: 15,\n      },\n    });\n    totalHits = response.data.totalHits;\n    renderImages(response.data.hits);\n  } catch (error) {\n    console.error(error);\n    iziToast.error({\n      message: 'Failed to fetch images. Please try again later.',\n    });\n  } finally {\n    loader.style.display = 'none';\n  }\n}\n\nfunction renderImages(images) {\n  if (images.length === 0) {\n    iziToast.warning({\n      message: 'No images found. Please try a different search query.',\n    });\n    loadMoreBtn.style.display = 'none';\n    return;\n  }\n\n  const galleryMarkup = images.hits\n    .map(\n      image =>\n        `<li class=\"gallery-item\">\n          <a class=\"gallery-link\" href=\"${image.largeImageURL}\">\n            <img class=\"gallery-image\" src=\"${image.webformatURL}\" alt=\"${image.tags}\" />\n          </a>\n          <div class=\"img-info\">\n            <p>Likes: ${image.likes}</p>\n            <p>Views: ${image.views}</p>\n            <p>Comments: ${image.comments}</p>\n            <p>Downloads: ${image.downloads}</p>\n          </div>\n        </li>`\n    )\n    .join('');\n\n  galleryEl.insertAdjacentHTML('beforeend', galleryMarkup);\n\n  let lightbox = new SimpleLightbox('.gallery a', {\n    captions: true,\n    captionDelay: 250,\n    captionsData: 'alt',\n  });\n  lightbox.refresh();\n\n  currentPage++;\n\n  if (cardHeight === 0) {\n    const firstCard = document.querySelector('.gallery-item');\n    const cardRect = firstCard.getBoundingClientRect();\n    cardHeight = cardRect.height;\n  }\n\n  window.scrollBy({\n    top: cardHeight * 2,\n    behavior: 'smooth',\n  });\n\n  if (totalHits <= galleryEl.children.length) {\n    loadMoreBtn.style.display = 'none';\n    endMessage.style.display = 'block';\n  }\n}\n\nasync function onLoadMore() {\n  loader.style.display = 'inline-block';\n  await fetchAndRenderImages();\n}\n"],"names":["formEl","galleryEl","loader","loadMoreBtn","endMessage","currentPage","searchQuery","totalHits","cardHeight","onSubmitForm","onLoadMore","e","getInputText","fetchAndRenderImages","response","axios","renderImages","error","iziToast","images","galleryMarkup","image","SimpleLightbox"],"mappings":"owBAwGA,MAAMA,EAAS,SAAS,cAAc,OAAO,EACvCC,EAAY,SAAS,cAAc,UAAU,EAC7CC,EAAS,SAAS,cAAc,SAAS,EACzCC,EAAc,SAAS,cAAc,YAAY,EACjDC,EAAa,SAAS,cAAc,cAAc,EACxD,IAAIC,EAAc,EACdC,EAAc,GACdC,EAAY,EACZC,EAAa,EAEjBN,EAAO,MAAM,QAAU,OACvBC,EAAY,MAAM,QAAU,OAE5BH,EAAO,iBAAiB,SAAUS,CAAY,EAC9CN,EAAY,iBAAiB,QAASO,CAAU,EAEhD,eAAeD,EAAaE,EAAG,CAC7BA,EAAE,eAAc,EAChBL,EAAcM,EAAY,EACtBN,IAAgB,KAGpBL,EAAU,UAAY,GACtBC,EAAO,MAAM,QAAU,eACvBG,EAAc,EACd,MAAMQ,EAAoB,EAC1BV,EAAY,MAAM,QAAU,eAC9B,CAEA,SAASS,GAAe,CACtB,OAAO,SAAS,cAAc,OAAO,EAAE,MAAM,KAAI,CACnD,CAEA,eAAeC,GAAuB,CACpC,GAAI,CACF,MAAMC,EAAW,MAAMC,EAAM,IAAI,2BAA4B,CAC3D,OAAQ,CACN,IAAK,qCACL,EAAGT,EACH,WAAY,QACZ,YAAa,aACb,WAAY,OACZ,KAAMD,EACN,SAAU,EACX,CACP,CAAK,EACDE,EAAYO,EAAS,KAAK,UAC1BE,EAAaF,EAAS,KAAK,IAAI,CAChC,OAAQG,EAAO,CACd,QAAQ,MAAMA,CAAK,EACnBC,EAAS,MAAM,CACb,QAAS,iDACf,CAAK,CACL,QAAY,CACRhB,EAAO,MAAM,QAAU,MACxB,CACH,CAEA,SAASc,EAAaG,EAAQ,CAC5B,GAAIA,EAAO,SAAW,EAAG,CACvBD,EAAS,QAAQ,CACf,QAAS,uDACf,CAAK,EACDf,EAAY,MAAM,QAAU,OAC5B,MACD,CAED,MAAMiB,EAAgBD,EAAO,KAC1B,IACCE,GACE;AAAA,0CACkCA,EAAM,aAAa;AAAA,8CACfA,EAAM,YAAY,UAAUA,EAAM,IAAI;AAAA;AAAA;AAAA,wBAG5DA,EAAM,KAAK;AAAA,wBACXA,EAAM,KAAK;AAAA,2BACRA,EAAM,QAAQ;AAAA,4BACbA,EAAM,SAAS;AAAA;AAAA,cAGtC,EACA,KAAK,EAAE,EAEVpB,EAAU,mBAAmB,YAAamB,CAAa,EAExC,IAAIE,EAAe,aAAc,CAC9C,SAAU,GACV,aAAc,IACd,aAAc,KAClB,CAAG,EACQ,QAAO,EAEhBjB,IAEIG,IAAe,IAGjBA,EAFkB,SAAS,cAAc,eAAe,EAC7B,wBACL,QAGxB,OAAO,SAAS,CACd,IAAKA,EAAa,EAClB,SAAU,QACd,CAAG,EAEGD,GAAaN,EAAU,SAAS,SAClCE,EAAY,MAAM,QAAU,OAC5BC,EAAW,MAAM,QAAU,QAE/B,CAEA,eAAeM,GAAa,CAC1BR,EAAO,MAAM,QAAU,eACvB,MAAMW,EAAoB,CAC5B"}