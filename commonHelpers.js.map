{"version":3,"file":"commonHelpers.js","sources":["../src/main.js"],"sourcesContent":["import axios from 'axios';\n\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\n\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nconst formEl = document.querySelector('.form');\nconst galleryEl = document.querySelector('.gallery');\nconst loader = document.querySelector('.loader');\nconst loadMoreBtn = document.querySelector('.load-more');\n\nlet currentPage = 1;\nlet searchQuery = '';\nlet totalHits = 0;\nlet cardHeight = 0;\n\nloader.style.display = 'none';\nloadMoreBtn.style.display = 'none';\n\nlet lightbox = new SimpleLightbox('.gallery a', {\n  captions: true,\n  captionDelay: 250,\n  captionsData: 'alt',\n});\n\nformEl.addEventListener('submit', onSubmitForm);\nloadMoreBtn.addEventListener('click', onLoadMore);\n\nasync function onSubmitForm(e) {\n  e.preventDefault();\n  searchQuery = document.querySelector('input').value.trim();\n\n  if (!searchQuery) return;\n\n  galleryEl.innerHTML = '';\n  loader.style.display = 'inline-block';\n  currentPage = 1;\n  await fetchAndRenderImages(searchQuery);\n  loadMoreBtn.style.display = 'inline-block';\n}\n\nasync function fetchAndRenderImages() {\n  try {\n    const response = await axios.get('https://pixabay.com/api/', {\n      params: {\n        key: '42110229-d56f9063956695e15527c98fc',\n        q: searchQuery,\n        image_type: 'photo',\n        orientation: 'horizontal',\n        safesearch: 'true',\n        page: currentPage,\n        per_page: 15,\n      },\n    });\n    totalHits = response.data.totalHits;\n    renderImages(response.data.hits);\n  } catch (error) {\n    console.error(error);\n    iziToast.error({\n      message: 'Failed to fetch images. Please try again later.',\n    });\n  } finally {\n    loader.style.display = 'none';\n  }\n}\n\nfunction renderImages(images) {\n  if (images.length === 0) {\n    iziToast.warning({\n      message: 'No images found. Please try a different search query.',\n    });\n    loadMoreBtn.style.display = 'none';\n    return;\n  }\n\n  const galleryMarkup = images\n    .map(\n      image =>\n        `<li class=\"gallery-item\">\n          <a class=\"gallery-link\" href=\"${image.largeImageURL}\">\n            <img class=\"gallery-image\" src=\"${image.webformatURL}\" alt=\"${image.tags}\" />\n          </a>\n          <div class=\"img-info\">\n            <p>Likes: ${image.likes}</p>\n            <p>Views: ${image.views}</p>\n            <p>Comments: ${image.comments}</p>\n            <p>Downloads: ${image.downloads}</p>\n          </div>\n        </li>`\n    )\n    .join('');\n\n  galleryEl.insertAdjacentHTML('beforeend', galleryMarkup);\n\n  lightbox.refresh();\n\n  currentPage++;\n\n  if (cardHeight === 0) {\n    const firstCard = document.querySelector('.gallery-item');\n    const cardRect = firstCard.getBoundingClientRect();\n    cardHeight = cardRect.height;\n  }\n\n  window.scrollBy({\n    top: cardHeight * 2,\n    behavior: 'smooth',\n  });\n\n  if (totalHits <= galleryEl.children.length) {\n    loadMoreBtn.style.display = 'none';\n  }\n}\n\nasync function onLoadMore() {\n  loader.style.display = 'inline-block';\n  await fetchAndRenderImages();\n}\n"],"names":["formEl","galleryEl","loader","loadMoreBtn","currentPage","searchQuery","totalHits","cardHeight","lightbox","SimpleLightbox","onSubmitForm","onLoadMore","e","fetchAndRenderImages","response","axios","renderImages","error","iziToast","images","galleryMarkup","image"],"mappings":"owBAQA,MAAMA,EAAS,SAAS,cAAc,OAAO,EACvCC,EAAY,SAAS,cAAc,UAAU,EAC7CC,EAAS,SAAS,cAAc,SAAS,EACzCC,EAAc,SAAS,cAAc,YAAY,EAEvD,IAAIC,EAAc,EACdC,EAAc,GACdC,EAAY,EACZC,EAAa,EAEjBL,EAAO,MAAM,QAAU,OACvBC,EAAY,MAAM,QAAU,OAE5B,IAAIK,EAAW,IAAIC,EAAe,aAAc,CAC9C,SAAU,GACV,aAAc,IACd,aAAc,KAChB,CAAC,EAEDT,EAAO,iBAAiB,SAAUU,CAAY,EAC9CP,EAAY,iBAAiB,QAASQ,CAAU,EAEhD,eAAeD,EAAaE,EAAG,CAC7BA,EAAE,eAAc,EAChBP,EAAc,SAAS,cAAc,OAAO,EAAE,MAAM,OAE/CA,IAELJ,EAAU,UAAY,GACtBC,EAAO,MAAM,QAAU,eACvBE,EAAc,EACd,MAAMS,EAAgC,EACtCV,EAAY,MAAM,QAAU,eAC9B,CAEA,eAAeU,GAAuB,CACpC,GAAI,CACF,MAAMC,EAAW,MAAMC,EAAM,IAAI,2BAA4B,CAC3D,OAAQ,CACN,IAAK,qCACL,EAAGV,EACH,WAAY,QACZ,YAAa,aACb,WAAY,OACZ,KAAMD,EACN,SAAU,EACX,CACP,CAAK,EACDE,EAAYQ,EAAS,KAAK,UAC1BE,EAAaF,EAAS,KAAK,IAAI,CAChC,OAAQG,EAAO,CACd,QAAQ,MAAMA,CAAK,EACnBC,EAAS,MAAM,CACb,QAAS,iDACf,CAAK,CACL,QAAY,CACRhB,EAAO,MAAM,QAAU,MACxB,CACH,CAEA,SAASc,EAAaG,EAAQ,CAC5B,GAAIA,EAAO,SAAW,EAAG,CACvBD,EAAS,QAAQ,CACf,QAAS,uDACf,CAAK,EACDf,EAAY,MAAM,QAAU,OAC5B,MACD,CAED,MAAMiB,EAAgBD,EACnB,IACCE,GACE;AAAA,0CACkCA,EAAM,aAAa;AAAA,8CACfA,EAAM,YAAY,UAAUA,EAAM,IAAI;AAAA;AAAA;AAAA,wBAG5DA,EAAM,KAAK;AAAA,wBACXA,EAAM,KAAK;AAAA,2BACRA,EAAM,QAAQ;AAAA,4BACbA,EAAM,SAAS;AAAA;AAAA,cAGtC,EACA,KAAK,EAAE,EAEVpB,EAAU,mBAAmB,YAAamB,CAAa,EAEvDZ,EAAS,QAAO,EAEhBJ,IAEIG,IAAe,IAGjBA,EAFkB,SAAS,cAAc,eAAe,EAC7B,wBACL,QAGxB,OAAO,SAAS,CACd,IAAKA,EAAa,EAClB,SAAU,QACd,CAAG,EAEGD,GAAaL,EAAU,SAAS,SAClCE,EAAY,MAAM,QAAU,OAEhC,CAEA,eAAeQ,GAAa,CAC1BT,EAAO,MAAM,QAAU,eACvB,MAAMW,EAAoB,CAC5B"}